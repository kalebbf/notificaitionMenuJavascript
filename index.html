<!DOCTYPE html>
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="demonstration of some noty ccss/apabilities">
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/noti-menuList_style.css">
    <link rel="stylesheet" type="text/css" href="css/animate.css">

    <link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic&amp;subset=latin,latin-ext,cyrillic' rel='stylesheet' type='text/css'>

    <script type="text/javascript" src="noty.menu.min.js"></script>    
    <script src="jquery-1.7.2.min.js"></script>

    <!-- noty -->

    <script type="text/javascript" src="jquery-1.11.3.js"></script>
    <input type="hidden" id="notificacao" value="clikaAkiDiacho" json='[{"texto":"teste de mensagem","tipo":"error","lido":"S"},{"texto":"teste de mensagem que nao foi lida segundo lugar da lista" , "tipo" : "success","lido":"N"},{"texto":"Para trabalhar com o fluxo DnD, precisamos da noção de um elemento de origem (em que o arrastar se origina), da carga de dados (o que estamos tentando arrastar) e de um destino (uma área para soltar). O elemento de origem pode ser uma imagem, uma lista, um link, um objeto de arquivo, um bloco de HTML... o que você quiser. O destino é a área (ou conjunto de áreas) onde o objeto será solto, que aceita os dados que o usuário está tentando soltar. Nem todos os elementos podem ser destinos (por exempl lista de json","tipo":"information" ,"lido":"N"}]'/>

    <title>Notify style</title>
</head>
<body>
    <div id="a"></div>
    <div id="containerGeralNotify" draggable="true">
        <div id="containerIconeBalao">
            <div id="balaoNotifi" class="balaoNotifi" onclick="abreLista();"></div>
            <div id="noty-menuList_numeroMsg" class="animated fadeInRight"></div></div>
            <div id="containerLista" style="display:none;"></div></div>
            <script type="text/javascript">
                (function( $ ){
/*	var accountent = $('div',{id:'noty-menuList_numeroMsg'}).addClass('animated fadeInRight');//cria div para mostrar o numero de novas mensagens
 		var containerGeral= $('div',{id:'containerGeralNotify'});// container geral do componente
        var containerIcon = $('div',{id:'containerIconeBalao'});// container do icone
        var containerNotify = $('div',{id:'balaoNotifi'});// container de notificacoe
        */
        var createElements ={
            li:function(){
                return document.createElement('li');    
            },
            ul:function(){
                return document.createElement('ul');
            }
        } ;
        var object = {
            initEvents:function(){
                $('#containerGeralNotify').on('click',function(){
                   $('#containerLista').toggle('slow');
               });
            },
            init:function(options){
               var count = options.count;
               count = (count>0 && typeof count!=='undefined' ? count: 0);
               $('#noty-menuList_numeroMsg').append(count);
               var ul = createElements.ul(); 
               ul.setAttribute('id','list-noty');
               options.listMessages.forEach(function(item, index){
                   var li =createElements.li();
                   var texto="";
                   if(item.texto.length > 69){
                    texto= item.texto.substring(0,65)+"...";
                }else{
                    texto = item.texto;
                }
                if(item.lido =='N'){        
                    li.setAttribute('class','item '+item.tipo);
                }else  
                if(item.lido =='S'){
                  li.setAttribute('class','item '+item.tipo+" noty-menuListlido");
              }
              li.setAttribute('obj',item.tipo);
              li.append(texto);
              ul.append(li);
          });
               $(ul).find('li').on('click',function(event){
                alert('open notification');
            });
               $('#containerLista').append(ul);   
           }
       };

       var methods = {
        init : function(options) {
            object.init(options);
            object.initEvents();
        },
        newMessage : function( ) {    },// IS
        openList : function( ) {  },// GOOD
        closeList : function( content ) {  }// !!!
    };

    $.fn.menuNoty = function(methodOrOptions) {
        if ( methods[methodOrOptions] ) {
            return methods[ methodOrOptions ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {
            // Default to "init"
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  methodOrOptions + ' does not exist on jQuery.tooltip' );
        }    
    };


})( jQuery );


$(document).ready(function(){
		$('div').menuNoty({count:2,listMessages:jQuery.parseJSON( $('input[id="notificacao"]').attr('json'))}); // calls the init method
	});
</script>
</body>
</html>